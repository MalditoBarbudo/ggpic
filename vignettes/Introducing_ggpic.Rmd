---
title: "Introduction to ggpic"
author: "Victor Granda"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to ggpic}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

`ggpic` extends `ggplot2` package adding geoms based on the the default ones, but
using raster objects instead of rect elements. This way you can make a barplot
with trees, buildings or leaves instead bars.

## Disclaimer

`ggpic` is made for fun, no serious bussiness here. I stumbled upon a very boring
barplot and I started thinking that, visually, it would be amazing to be able
to represent tree drawings instead bars.  
Thanks to the nice guys at RStudio (Hadley Wickham, Winston Chang and others)
there is a wonderful resource about
[extending ggplot](http://docs.ggplot2.org/dev/vignettes/extending-ggplot2.html).
Also, [emoGG](https://github.com/dill/emoGG) does something similar substituting
points with emojis, and [rphylopic](https://github.com/sckott/rphylopic) allows
you to add pics to the plots, so I thought *why not?*.  
And the result is `ggpic`.

### Not serious bussiness, but useful

I'm not advocating for barplots. I prefer boxplots when communicating results
in reports or papers. But sometimes, barplots can be useful when communicating
informative data not intended for analysis in presentations or posters. Think,
for example, that you want to show the number of trees measured in several
locations. You can present a table, nice for reports and papers or you can
present a barplot summarising the table, which is good for posters and
presentations. Now, if instead of bars you represent a drawing of the tree
and map it to the y variable it would make the plot more attractive to the
audience (I think). So this is where `ggpic` enters in the game. It allows
exactly that.

## Installation

`ggpic` is only available from GitHub at the moment. You can install it using
`devtools` package:

```{r, eval=FALSE}
# install devtools if necessary
install.packages('devtools')

# install ggpic
devtools::install_github('MalditoBarbudo/ggpic', build_vignettes = TRUE)
```

## Usage

`geom_bar_pic` works as `bar_geom`, so it needs at least an `x` aesthetic. It
also uses a `pic` aesthetic to indicate the image to use.

```{r basic_plot, message = FALSE, fig.align='center', fig.width=6}
# libraries
library(ggplot2)
library(ggpic)
library(dplyr)

# pic
leaf <- as.matrix(as.raster(rsvg::rsvg(
  system.file('pics', 'leaf.svg', package = 'ggpic')
)))

# plot
iris %>%
  ggplot(aes(x = Species)) +
  geom_bar_pic(pic = 'leaf')
```

***

It also accepts an `y` aesthetic, in combination with `stat = identity`, to map
y value to a variable value:

```{r y_aes, message = FALSE, fig.align='center', fig.width=6}
# plot
iris %>%
  group_by(Species) %>%
  summarise_all(funs(mean)) %>%
  ggplot(aes(x = Species)) +
  geom_bar_pic(aes(y = Petal.Width), stat = 'identity', pic = 'leaf')
```

***

`geom_bar_pic` can use the `fill` and the `alpha` aesthetics, and also the
`width` parameter from `geom_bar`. This could be useful to avoid excesive
pic deformation:

```{r fill_alpha_width, message = FALSE, fig.align='center', fig.width=6}
# width
iris %>%
  group_by(Species) %>%
  summarise_all(funs(mean)) %>%
  ggplot(aes(x = Species)) +
  geom_bar_pic(aes(y = Petal.Width),
               stat = 'identity', pic = 'leaf', width = 0.6)

# fill
iris %>%
  group_by(Species) %>%
  summarise_all(funs(mean)) %>%
  ggplot(aes(x = Species, fill = Species)) +
  geom_bar_pic(aes(y = Petal.Width),
               stat = 'identity', pic = 'leaf', width = 0.6)

# alpha
iris %>%
  group_by(Species) %>%
  summarise_all(funs(mean)) %>%
  ggplot(aes(x = Species, fill = Species)) +
  geom_bar_pic(aes(y = Petal.Width),
               stat = 'identity', pic = 'leaf', width = 1.3, alpha = 0.5)
```

As it can be seen in the last two plots, `geom_bar_pic` also provides a
legend with the pic and the corresponding fill colour (see `?draw_key_pic`).

***

The `pic` aesthetic, as any other, can be mapped to a variable. In this case it is
necessary to provide a scale for the `pic` aesthetic with the `scale_pic_manual`
function:

```{r scale, message = FALSE, fig.align='center', fig.width=6}
# data
data <- data.frame(
  Site = rep(LETTERS[1:3], 2),
  Species = rep(c('Pine', 'Ash'), each = 3),
  Height = rpois(6, 15),
  Deep = rpois(6, 2.2),
  stringsAsFactors = FALSE
)

# pics
pine <- as.matrix(as.raster(rsvg::rsvg(
  system.file('pics', 'pine_tree_2.svg', package = 'ggpic')
)))
ash <- as.matrix(as.raster(rsvg::rsvg(
  system.file('pics', 'deciduous_tree_2.svg', package = 'ggpic')
)))

# plot
ggplot(data,
       aes(x = Site, pic = Species, fill = Species)) +
  geom_bar_pic(aes(y = Height), stat = 'identity') +
  scale_pic_manual(values = c('ash', 'pine'))
```

## Pics

**TODO** Some info about the raster objects